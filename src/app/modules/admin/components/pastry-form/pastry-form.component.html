<form nz-form [formGroup]="validateForm" (ngSubmit)="submitForm()">
  <nz-form-item>
    <nz-form-label [nzSm]="8" [nzXs]="24" nzRequired>Nom</nz-form-label>
    <nz-form-control [nzSm]="12" [nzXs]="24" nzHasFeedback nzValidatingTip="En cours de validation..." [nzErrorTip]="nameErrorTpl">
      <input nz-input formControlName="name" placeholder="Gaufre choco fraise" />
      <ng-template #nameErrorTpl let-control>
        <ng-container *ngIf="control.hasError('required')">Merci d'entrer un nom</ng-container>
        <ng-container *ngIf="control.hasError('minlength')">Merci d'entrer un nom de plus de 3 caractères</ng-container>
        <ng-container *ngIf="control.hasError('maxlength')">Merci d'entrer un nom de moins de 100 caractères</ng-container>
        <ng-container *ngIf="control.hasError('duplicated')">Le nom est déjà pris</ng-container>
      </ng-template>
    </nz-form-control>
  </nz-form-item>
  <nz-form-item>
    <nz-form-label [nzSm]="8" [nzXs]="24" nzRequired>Description</nz-form-label>
    <nz-form-control [nzSm]="12" [nzXs]="24" [nzErrorTip]="descriptionErrorTpl">
      <nz-textarea-count [nzMaxCharacterCount]="500">
        <textarea rows="4" nz-input formControlName="description" placeholder="Le goût puissant d'une pâte à tartiner maison + coulis de fraise"></textarea>
      </nz-textarea-count>
      <ng-template #descriptionErrorTpl let-control>
        <ng-container *ngIf="control.hasError('required')">Merci d'entrer une description</ng-container>
        <ng-container *ngIf="control.hasError('minlength')">Merci d'entrer une description de plus de 10 caractères</ng-container>
        <ng-container *ngIf="control.hasError('maxlength')">Merci d'entrer une description de moins de 500 caractères</ng-container>
      </ng-template>
    </nz-form-control>
  </nz-form-item>
  <nz-form-item>
    <nz-form-label [nzSm]="8" [nzXs]="24" nzRequired>Prix</nz-form-label>
    <nz-form-control [nzSm]="12" [nzXs]="24" [nzErrorTip]="priceErrorTpl">
      <nz-input-number-group nzAddOnAfter="€">
        <nz-input-number formControlName="price" [nzStep]="0.5" [nzMin]="0" placeholder="3"></nz-input-number>
      </nz-input-number-group>
      <ng-template #priceErrorTpl let-control>
        <ng-container *ngIf="control.hasError('required')">Merci d'entrer un prix (même 0)</ng-container>
      </ng-template>
    </nz-form-control>
  </nz-form-item>
  <nz-form-item>
    <nz-form-label [nzSm]="8" [nzXs]="24">Ingrédients</nz-form-label>
    <nz-form-control [nzSm]="12" [nzXs]="24">
      <nz-tag
        *ngFor="let ingredient of validateForm.controls['ingredients'].value; let i = index"
        [nzMode]="'closeable'"
        (nzOnClose)="handleClose(ingredient)"
      >
        {{ (ingredient.length > 20) ? (ingredient | slice:0:20) + '…' : ingredient }}
      </nz-tag>
      <nz-tag *ngIf="!ingredientsInputVisible" class="editable-tag" nzNoAnimation (click)="showInput()">
        <span nz-icon nzType="plus"></span>
        Ajouter
      </nz-tag>
      <input
        #inputElement
        nz-input
        nzSize="small"
        *ngIf="ingredientsInputVisible"
        type="text"
        [value]="ingredientsInputValue"
        (input)="handleChanges($event)"
        style="width: 78px;"
        (blur)="handleInputConfirm(false)"
        (keydown.enter)="handleInputConfirm()"
      />
    </nz-form-control>
  </nz-form-item>
  <nz-form-item>
    <nz-form-label [nzSm]="8" [nzXs]="24">Stock</nz-form-label>
    <nz-form-control [nzSm]="12" [nzXs]="24">
      <nz-input-number formControlName="stock" [nzStep]="1" [nzMin]="0" placeholder="50"></nz-input-number>
    </nz-form-control>
  </nz-form-item>
  <nz-form-item>
    <nz-form-label [nzSm]="8" [nzXs]="24">Caché</nz-form-label>
    <nz-form-control [nzSm]="12" [nzXs]="24">
      <nz-radio-group formControlName="hidden">
        <label nz-radio-button [nzValue]="true">Caché</label>
        <label nz-radio-button [nzValue]="false">Visible</label>
      </nz-radio-group>
    </nz-form-control>
  </nz-form-item>
  <nz-form-item>
    <nz-form-label [nzSm]="8" [nzXs]="24">Séquence</nz-form-label>
    <nz-form-control [nzSm]="12" [nzXs]="24">
      <nz-input-number formControlName="displaySequence" [nzStep]="1" [nzMin]="0"></nz-input-number>
    </nz-form-control>
  </nz-form-item>
</form>
