<nz-ribbon [class.-is-loading]="isLoading" nzText="‚Ç¨" [nzColor]="isPayed ? 'green' : 'red'">
  <nz-card style="width: 300px" [class.-is-new]="isNew" [class.-is-just-updated]="isJustUpdated"
    [nzActions]="noAction ? [] : isDone && isPayed ? [actionWizz] : isDone ? [actionWizz, actionPayed] : isPayed ? [actionWizz, actionDone] : [actionWizz, actionPayed, actionDone]" [nzTitle]="'Commande #' + command.reference">
    <nz-skeleton [nzActive]="true" [nzLoading]="isLoading">
      <p class="take-away">{{ command.takeAway ? '√Ä emporter üöö' : 'Sur place ‚õ±Ô∏è' }}</p>
      <nz-divider></nz-divider>
      <p>Nom : {{ command.name }}</p>
      <p [class.-pick-up-time]="command.pickUpTime">R√©cup√©ration : {{ !!command.pickUpTime ? (command.pickUpTime | date: "dd/MM/YYYY HH:mm") : 'Maintenant' }}</p>
      <p>Commande :</p>
      <ng-container *ngFor="let pastryType of pastries">
        <span class="pastry-type">{{ PASTRY_TYPE_LABEL[pastryType[0]].label }}</span>
        <ul>
          <li *ngFor="let pastry of pastryType[1]">
            {{ pastry[0].name + " (x" + pastry[1] + ")" }}
          </li>
        </ul>
      </ng-container>
      <p>Prix total : {{ command.totalPrice }}‚Ç¨</p>
      <p>Cr√©√©e le : {{ command.createdAt | date: "dd/MM/YYYY HH:mm" }}</p>
      <p>Modifi√©e le : {{ command.updatedAt | date: "dd/MM/YYYY HH:mm" }}</p>
      <ng-container *ngIf="command.payment?.length">
        <p>Paiements :</p>
        <ul>
          <li *ngFor="let payment of command.payment">
            <span [ngStyle]="{ color: PAYMENT_METHOD_LABEL[payment.key].color, 'font-weight': 500 }">{{ PAYMENT_METHOD_LABEL[payment.key].label }}</span>
            {{ " (" + payment.value + "‚Ç¨)" }}
          </li>
        </ul>
      </ng-container>
    </nz-skeleton>
  </nz-card>
</nz-ribbon>
<ng-template #actionWizz>
  <i nz-icon nzType="bell" (click)="!isLoading && wizzClient()"></i>
</ng-template>
<ng-template #actionDone>
  <ng-container *ngIf="!isDone">
    <i nz-icon nzType="check" (click)="!isLoading && showValidationPopup('toDone')"></i>
  </ng-container>
</ng-template>
<ng-template #actionPayed>
  <ng-container *ngIf="!isPayed">
    <i nz-icon nzType="euro-circle" (click)="!isLoading && showValidationPopup('toPayed')"></i>
  </ng-container>
</ng-template>

<app-payment-modal *ngIf="isPaymentModalVisible" (clickCancel)="isPaymentModalVisible = false;" (clickOk)="payingCommand($event);"
  [command]="command"></app-payment-modal>
